<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£ | BENE Wedding Project</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --cream:#f6f1e9;
  --cream-dark:#e9e1d6;
  --brown:#5b4636;
  --accent:#b08a5a;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Sarabun,sans-serif;
  background:var(--cream);
  color:var(--brown);
  display:flex;
  justify-content:center;
}

.container{
  max-width:980px;
  width:100%;
  padding:20px;
}

header{
  text-align:center;
  margin-bottom:14px;
}

header h1{
  margin:0;
  font-weight:600;
  letter-spacing:1px;
}

header p{
  margin:6px 0 0;
  font-size:14px;
  opacity:.8;
}

/* ===== Canvas Card ===== */
.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}

canvas{
  width:100%;
  height:auto;
  aspect-ratio: 3 / 2;
  border:2px dashed var(--cream-dark);
  border-radius:12px;
  background:#fff;
  touch-action:none;
  cursor:crosshair;
}

/* ===== Controls ===== */
.controls{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  justify-content:center;
  margin-top:14px;
}

.control-group{
  display:flex;
  align-items:center;
  gap:6px;
}

select,button{
  font-family:inherit;
  font-size:15px;
  padding:8px 14px;
  border-radius:999px;
  border:1px solid var(--cream-dark);
  background:#fff;
  cursor:pointer;
}

button.primary{
  background:var(--accent);
  color:#fff;
  border:none;
}

button.danger{
  background:#eee;
}

footer{
  text-align:center;
  margin-top:14px;
  font-size:12px;
  opacity:.6;
}

/* Mobile */
@media(max-width:600px){
  header h1{font-size:20px}
}
</style>
</head>
<body>

<div class="container">

  <header>
    <h1>‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡πÉ‡∏´‡πâ‡∏ö‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏ß</h1>
    <p>‡πÄ‡∏ä‡∏¥‡∏ç‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÉ‡∏à üíõ</p>
  </header>

  <div class="card">
    <canvas id="canvas" width="900" height="600"></canvas>

    <div class="controls">
      <div class="control-group">
        ‡∏™‡∏µ:
        <select id="color">
          <option value="#2f2f2f">‡∏î‡∏≥</option>
          <option value="#2b5fb8" selected>‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</option>
          <option value="#c0392b">‡πÅ‡∏î‡∏á</option>
          <option value="#1e8449">‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</option>
        </select>
      </div>

      <div class="control-group">
        ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤:
        <select id="width">
          <option value="6">‡∏ö‡∏≤‡∏á</option>
          <option value="8" selected>‡∏õ‡∏Å‡∏ï‡∏¥</option>
          <option value="12">‡∏´‡∏ô‡∏≤</option>
        </select>
      </div>

      <button class="danger" onclick="clearCanvas()">‡∏•‡πâ‡∏≤‡∏á</button>
      <button class="primary" onclick="saveCanvas()">‡∏™‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏≠</button>
    </div>
  </div>

  <footer>
    By BENE Wedding Project
  </footer>

</div>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
/* ===== Supabase config ===== */
const SUPABASE_URL = "https://ntyqqenchkojmhfyaegx.supabase.co";
const SUPABASE_ANON_KEY = "PUT_YOUR_PUBLISHABLE_KEY_HERE";

const supabase = supabase.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
);

/* ===== Canvas ===== */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const colorEl = document.getElementById("color");
const widthEl = document.getElementById("width");

let drawing=false;
let lastX=0,lastY=0;

canvas.addEventListener("pointerdown",e=>{
  drawing=true;
  canvas.setPointerCapture(e.pointerId);
  lastX=e.offsetX;
  lastY=e.offsetY;
});

canvas.addEventListener("pointermove",e=>{
  if(!drawing) return;

  ctx.strokeStyle=colorEl.value;
  ctx.lineWidth=widthEl.value;
  ctx.lineCap="round";
  ctx.lineJoin="round";

  ctx.beginPath();
  ctx.moveTo(lastX,lastY);
  ctx.lineTo(e.offsetX,e.offsetY);
  ctx.stroke();

  lastX=e.offsetX;
  lastY=e.offsetY;
});

["pointerup","pointercancel","pointerleave"].forEach(ev=>{
  canvas.addEventListener(ev,()=>drawing=false);
});

/* ===== Actions ===== */
function clearCanvas(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
}

async function saveCanvas(){
  const blob = await new Promise(r=>canvas.toBlob(r,"image/png"));
  const filename = `signature_${Date.now()}.png`;

  const { error } = await supabase
    .storage
    .from("signatures")
    .upload(filename, blob, { upsert:true });

  if(error){
    alert("‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
    return;
  }

  clearCanvas();
  alert("‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úçÔ∏è");
}
</script>

</body>
</html>
