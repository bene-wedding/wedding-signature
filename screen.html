<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BENE Wedding – Display</title>

<link href="https://fonts.googleapis.com/css?family=Kanit:400,600&display=swap" rel="stylesheet">

<style>
:root{
  --cream:#f5efe6;
  --brown:#7a5c42;
  --accent:#b89b7b;
}

body{
  margin:0;
  background:var(--cream);
  font-family:'Kanit',sans-serif;
  overflow:hidden;
}

/* WAITING */
#waiting{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  color:#fff;
  background:linear-gradient(
    rgba(184,155,123,.85),
    rgba(122,92,66,.85)
  );
  animation:fade 3s ease-in-out infinite;
}

#waiting h1{
  font-size:56px;
  margin:0;
}

#waiting p{
  margin-top:12px;
  font-size:20px;
  opacity:.9;
}

/* SIGNATURE */
#signature{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  max-width:85%;
  max-height:85%;
  display:none;
  animation:showUp .8s ease;
}

/* COUNTDOWN */
#countdown{
  position:absolute;
  bottom:24px;
  left:30px;
  font-size:14px;
  color:rgba(0,0,0,.45);
  display:none;
}

/* CREDIT */
#credit{
  position:absolute;
  bottom:20px;
  right:30px;
  font-size:16px;
  color:rgba(0,0,0,.4);
}

/* animations */
@keyframes fade{
  0%{opacity:.4}
  50%{opacity:1}
  100%{opacity:.4}
}

@keyframes showUp{
  from{
    opacity:0;
    transform:translate(-50%,-50%) scale(.95);
  }
  to{
    opacity:1;
    transform:translate(-50%,-50%) scale(1);
  }
}
</style>
</head>
<body>

<!-- WAITING -->
<div id="waiting">
  <h1>เชิญเขียนคำอวยพรเจ้าบ่าวเจ้าสาว</h1>
  <p>ด้วยลายมือของคุณ</p>
</div>

<!-- SIGNATURE -->
<img id="signature">

<!-- COUNTDOWN -->
<div id="countdown">เปลี่ยนใน 30 วินาที</div>

<div id="credit">By BENE Wedding Project</div>

<script>
const waiting = document.getElementById("waiting");
const img = document.getElementById("signature");
const countdownEl = document.getElementById("countdown");

let lastImage = null;
let showTimer = null;
let countdownTimer = null;
let seconds = 30;

/* แสดงลายเซ็น */
function showSignature(src){
  waiting.style.display = "none";
  img.src = src;
  img.style.display = "block";

  startCountdown();

  clearTimeout(showTimer);
  showTimer = setTimeout(showWaiting, 30000);
}

/* กลับหน้า WAITING */
function showWaiting(){
  img.style.display = "none";
  waiting.style.display = "flex";
  countdownEl.style.display = "none";
  clearInterval(countdownTimer);
}

/* นับถอยหลัง */
function startCountdown(){
  seconds = 30;
  countdownEl.style.display = "block";
  countdownEl.textContent = `เปลี่ยนใน ${seconds} วินาที`;

  clearInterval(countdownTimer);
  countdownTimer = setInterval(()=>{
    seconds--;
    countdownEl.textContent = `เปลี่ยนใน ${seconds} วินาที`;
    if(seconds <= 0){
      clearInterval(countdownTimer);
    }
  },1000);
}

/* ตรวจข้อมูลทุก 1 วิ */
setInterval(()=>{
  const imgData = localStorage.getItem("lastSignature");

  if(!imgData){
    showWaiting();
    lastImage = null;
    return;
  }

  if(imgData !== lastImage){
    lastImage = imgData;
    showSignature(imgData);
  }
},1000);

/* เริ่มต้น */
showWaiting();
</script>

</body>
</html>
